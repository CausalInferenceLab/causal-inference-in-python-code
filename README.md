# 『실무로 통하는 인과추론 with 파이썬』 

이 저장소는 한빛출판사에서 출간한 한국어판 "실무로 통하는 인과추론 with 파이썬"에서 참조하는 각종 자료 및 소스 코드와 예제 데이터를 담고 있습니다. 이 책은 다음 서점에서 절찬리에 판매중입니다([교보문고](https://product.kyobobook.co.kr/detail/S000212577153), [예스24](https://www.yes24.com/Product/Goods/125196916), [인터파크](https://book.interpark.com/product/BookDisplay.do?_method=detail&sc.shopNo=0000400000&sc.prdNo=356878902&sc.saNo=003002001&bid1=search&bid2=product&bid3=title&bid4=001), [알라딘](https://www.aladin.co.kr/shop/wproduct.aspx?ItemId=335177841), [한빛미디어](https://www.hanbit.co.kr/store/books/look.php?p_code=B6208936856))

![img](./실무로%20통하는%20인과추론%20with%20파이썬/data/book_cover.jpg)

# 책 소개 #
독자 여러분은 "상관관계는 인과관계가 아니다"라는 말을 많이 들어보셨죠? 이 책은 상관관계가 왜 인과관계와 다른지 그리고 데이터 과학자의 시각에서 인과추론의 기초부터 심화에 이르기까지의 내용을 다양한 실무 사례를 바탕으로 설명합니다. 또한, 인과추론 방법론에 그치지 않고 실무에서의 데이터 분석가 또는 데이터 과학자가 고민하는 수준의 실험 결과의 신뢰성 및 추론 부분까지 다루고 있습니다. 여러분이 인과추론을 처음 접하셨다면, 내용을 바탕으로 파이썬 실습 위주로 진행해볼 수 있고, 데이터 분석가/과학자라면 사례를 중심으로 여러분의 도메인에 접목시켜 학습하는 것을 추천드립니다. 


주요 내용은 다음과 같습니다.
- 인과추론의 기본 개념과 활용법 익히기
- 인과추론과 편향의 관계 이해하기
- 인과추론으로 비즈니스 문제 해결하기
- 인과추론으로 고객을 시간에 따라 관찰하기
- 인과효과가 실험 대상마다 다를 수 있는 이유 학습하기


한국에서는 실무자가 접할 수 있는 인과추론에 대한 자료가 많이 부족하다고 생각합니다. 이 책이 여러분의 인과추론 학습에 있어 좋은 길잡이가 되길 바랍니다.
책에 대한 문의는 [제 블로그](https://jinsooshin.tistory.com/) 또는 [가짜연구소 Discord](https://discord.gg/HeHbFAvmSZ)를 통해 이야기해주세요.
+ 박지용 교수님의 ["인과추론과 데이터과학"](https://www.youtube.com/@causaldatascience) 강의와 함께 학습하면 더 좋습니다!


# 역자 정보
## [신진수](https://www.linkedin.com/in/jinsoo-shin-436060162/)
네오플을 거쳐 크래프톤의 데이터 분석가로 일하고 있습니다. 게임 업계에서 쌓은 커리어를 기반으로 <던전앤파이터>, <뉴스테이트 모바일>, <배틀그라운드 모바일> 등 다양한 장르의 게임에서 데이터 분석과 실험을 통해 유저 경험을 개선하는 데 기여했습니다. 비영리 데이터 사이언스 커뮤니티인 가짜연구소에서 인과추론팀을 운영 중입니다. 마테우스 파쿠레의 웹북 [「Causal Inference for The Brave and True」](https://github.com/CausalInferenceLab/Causal-Inference-with-Python)를 한국어로 번역하는 작업을 주도했습니다 ([블로그](https://jinsooshin.tistory.com/) / [Github](https://github.com/jsshin2022))


## [가짜연구소 인과추론팀](https://pseudo-lab.com/6bbf03d9f11d4af687c0f03c6db39b1b)
가짜연구소 인과추론팀은 2022년부터 데이터를 통한 문제해결력을 높이고자 인과추론을 함께 학습하고 있습니다. 한국어 자료가 많지 않은 인과추론을 많은 분이 쉽게 접하실 수 있도록 기여하고자 하는 마음으로, 가짜연구소에서 인과추론 이야기와 실험 및 조직문화에 대한 이야기를 이어나가고 있습니다. 이 책의 번역 작업에는 인과추론팀 김소희, 김성수, 김상돈, 김준영, 남궁민상, 박시온, 최은희, 정호재, 홍성철이 함께 참여했습니다.


# 챕터별 자료

### 참고 도서
| 도서 | 
| ------ |
| [Causal Inference Stanford STATS 361 강의 노트](https://web.stanford.edu/~swager/stats361.pdf) | 
| Causal Inference for the Brave and True ([원서](https://github.com/matheusfacure/python-causality-handbook) / [번역서](https://github.com/CausalInferenceLab/Causal-Inference-with-Python)) | 
| [Causal Inference for Statistics, Social, and Biomedical Sciences](https://www.amazon.com/Causal-Inference-Statistics-Biomedical-Sciences/dp/0521885884) |


### 1장-인과추론 소개

| 챕터 | 내용 | 자료 링크 | 
| ------ |------|------|
| 1.6 인과효과 식별하기 | 더 알아보기 | [Causal Inference and Data Fusion in Econometrics](https://arxiv.org/abs/1912.09104) |


### 2장-무작위 실험 및 기초 통계 리뷰

| 챕터 | 내용 | 자료 링크 | 
| ------ |------|------|
| 2.2 A/B 테스트 사례 | 시뮬레이션 데이터와 실제 데이터 비교 | [A Randomized Assessment of Online Learning](https://www.aeaweb.org/articles?id=10.1257/aer.p20161057) |
| 2.4 가장 위험한 수식 | 하워드 웨이너의 유명한 글 | [The Most Dangerous Equation](https://www.americanscientist.org/article/the-most-dangerous-equation) |
| 2.5 추정값의 표준오차 | MIT의 통계학 입문 강좌 | [Introduction to statistics](https://www.youtube.com/watch?v=VPZD_aij8H0&list=PLUl4u3cNGP60uVBMaoNERc6knT_MgPKS0) |
| 2.6 신뢰구간 | 실제 사례: 코로나19 백신의 효과 | [Efficacy and Safety of the mRNA-1273 SARS-CoV-2 Vaccine](https://www.nejm.org/doi/full/10.1056/nejmoa2035389) |
| 2.8 p 값 | 실제 사례: 실제 사례: 대면 강의 vs. 온라인 강의 | [Is It Live or Is It Internet? Experimental Estimates of the Effects of Online Instruction on Student Learning](https://www.journals.uchicago.edu/doi/10.1086/669930) |
| 2.10 표본 크기 계산 | 더 알아보기 | [A/B Testing Intuition Busters: Common Misunderstandings in Online Controlled Experiments](https://dl.acm.org/doi/abs/10.1145/3534678.3539160) |

### 3장-그래프 인과모델
| 챕터 | 내용 | 자료 링크 | 
| ------ |------|------|
| 3.7.2 랜덤화 재해석 | 민감도 분석과 부분 식별 | [Making Sense of Sensitivity: Extending Omitted Variable Bias](https://academic.oup.com/jrsssb/article/82/1/39/7056023) |
| 3.8.1 충돌부를 조건부 설정 | 더 알아보기 | [DAGitty](https://www.dagitty.net/), [A Crash Course in Good and Bad Controls](https://journals.sagepub.com/doi/epub/10.1177/00491241221099552) |

### 4장-유용한 선형회귀
| 챕터 | 내용 | 자료 링크 | 
| ------ |------|------|
| 4.1 선형회귀의 필요성 | OLS 연구 | [Difference-in-differences with variation in treatment timing](https://www.sciencedirect.com/science/article/abs/pii/S0304407621001445), [Interpreting Ols Estimands When Treatment Effects are Heterogeneous: Smaller Groups](https://direct.mit.edu/rest/article/104/3/501/97692/Interpreting-OLS-Estimands-When-Treatment-Effects), [Contamination Bias in Linear Regressions](https://arxiv.org/abs/2106.05024) |
| 4.7.5 평균 제거와 고정효과 | 패널데이터를 사용한 인과추론 논문 | [On the Pooling of Time Series and Cross Section Data](https://www.jstor.org/stable/1913646) |
| 4.9 중립 통제변수 | 잡음 제거 기법 | [Improving the Sensitivity of Online Controlled Experiments by Utilizing Pre-Experiment Data](http://robotics.stanford.edu/~ronnyk/2013-02CUPEDImprovingSensitivityOfControlledExperiments.pdf) |


### 5장-성향점수
| 챕터 | 내용 | 자료 링크 | 
| ------ |------|------|
| 5.1 관리자 교육의 효과 | 민감도 분석과 부분 식별 | [Estimating Treatment Effects with Causal Forests: An Application](https://arxiv.org/abs/1902.07409) |
| 5.3.3 성향점수 매칭 | 민감도 분석과 부분 식별 | [Why Propensity Scores Should Not Be Used for Matching](https://gking.harvard.edu/publications/why-Propensity-Scores-Should-Not-Be-Used-Formatching) |
| 5.3.5 역확률 가중치의 분산 | 실제 사례: 인과적 콘텍스트 밴딧 | [A Contextual-Bandit Approach to Personalized News Article Recommendation](https://arxiv.org/abs/1003.0146) |
| 5.5 이중 강건 추정 | 이중 강건 추정량 주석 | [An Introduction to the Augmented Inverse Propensity Weighted Estimator](https://www.law.berkeley.edu/files/AIPW(1).pdf) |
| 5.5.2 결과 모델링이 쉬운 경우 | 더 알아보기 | [Comment: Performance of Double-Robust Estimators When “Inverse Probability” Weights Are Highly Variable](https://arxiv.org/pdf/0804.2965.pdf) |
| 5.6 연속형 처치에서의 일반화 성향점수 | 연속형 처치 | [Causal inference with a continuous treatment and outcome: Alternative estimators for parametric dose-response functions with applications](https://www.proquest.com/openview/888e50198b2563222f8e2030e5a8c9e7/1?pq-origsite=gscholar&cbl=18750) |


### 6장-이질적 처치효과
| 챕터 | 내용 | 자료 링크 | 
| ------ |------|------|
| 6.7 누적 이득 곡선 | 더 알아보기 | [Nubank fklearn](https://github.com/nubank/fklearn), [Causal inference and uplift modeling a review of the literature](https://proceedings.mlr.press/v67/gutierrez17a/gutierrez17a.pdf), [Empirical Analysis of Model Selection for Heterogeneous Causal Effect Estimation](https://arxiv.org/abs/2211.01939) |
| 6.8 목표 변환 | 더 알아보기 | [Intelligent Credit Limit Management in Consumer Loans Based on Causal Inference](https://arxiv.org/abs/2007.05188) |
| 6.9.2 이진 결과 | 더 알아보기 | [Causal Classification: Treatment Effect Estimation vs. Outcome Prediction](https://jmlr.org/papers/v23/19-480.html) |


### 7장-메타러너
| 챕터 | 내용 | 자료 링크 | 
| ------ |------|------|
| 7.1 이산형 처치 메타러너 | 인과추론 라이브러리 | [EconML 공식문서](https://econml.azurewebsites.net/), [CausalML 공식문서](https://causalml.readthedocs.io/en/latest/about.html) |
| 7.1.1 T 러너 | 더 알아보기 | [Metalearners for estimating heterogeneous treatment effects using machine learning](https://www.pnas.org/doi/full/10.1073/pnas.1804597116) |
| 7.2.1 S 러너 | S 러너의 편향 | [Double/Debiased/Neyman Machine Learning of Treatment Effects](https://www.aeaweb.org/articles?id=10.1257/aer.p20171038) |
| 7.2.2 이중/편향 제거 머신러닝 | 트리 기반 및 신경망 러너 | [Nonparametric Estimation of Heterogeneous Treatment Effects:From Theory to Learning Algorithms](https://proceedings.mlr.press/v130/curth21a/curth21a.pdf), [Learning Representations for Counterfactual Inference](https://proceedings.mlr.press/v48/johansson16.pdf) |


### 8장-이중차분법
| 챕터 | 내용 | 자료 링크 | 
| ------ |------|------|
| 8.2 표준 이중차분법 | 실제 사례: 최저임금과 고용 | [Minimum Wages and Employment: A Case Study of the Fast-Food Industry in New Jersey and Pennsylvania](https://davidcard.berkeley.edu/papers/njmin-aer.pdf) |
| 8.2.5 추론 | 더 알아보기 | [When Should You Adjust Standard Errors for Clustering?](https://academic.oup.com/qje/article/138/1/1/6750017), [An Exact and Robust Conformal Inference Method for Counterfactual and Synthetic Controls](https://www.tandfonline.com/doi/full/10.1080/01621459.2021.1920957) |
| 8.3 식별 가정 | 더 알아보기 | [When Is Parallel Trends Sensitive to Functional Form?](https://cowles.yale.edu/sites/default/files/2022-11/2010.04814.pdf) |
| 8.3.2 비기대 가정과 SUTVA | 공간적 파급 효과 | [Difference-in-Differences Estimation with Spatial Spillovers](https://arxiv.org/abs/2105.03737) |
| 8.3.5 피드백 없음 | 순차적 무시 가능성 | [Causal Inference with Time-Series Cross-Sectional Data: A Reflection](https://papers.ssrn.com/sol3/papers.cfm?abstract_id=3979613) |
| 8.3.6 이월 효과와 시차종속변수 없음 | 순차적 무시 가능성 | [When Should We Use Unit Fixed Effects Regression Models for Causal Inference with Longitudinal Data?](https://imai.fas.harvard.edu/research/files/FEmatch.pdf) |
| 8.6.3 최종 결과 | 이중 강건 이중차분법 | [Doubly robust difference-in-differences estimators](https://www.sciencedirect.com/science/article/abs/pii/S0304407620301901) |
| 8.7 처치의 시차 도입 | 이중 강건 이중차분법 | [Difference-in-differences with variation in treatment timing](https://www.sciencedirect.com/science/article/abs/pii/S0304407621001445) |
| 8.7 처치의 시차 도입 | 실제 사례: 개발도상국의 고등교육과 성장 | [Higher Education Expansion, Labor Market, and Firm Productivity in Vietnam](https://sites.google.com/view/khoavu-umn/job-market-paper) |
| 8.7.1 시간에 따른 이질적 효과 | 더 알아보기 | [Estimating dynamic treatment effects in event studies with heterogeneous treatment effects](https://www.sciencedirect.com/science/article/abs/pii/S030440762030378X), [Two-Way Fixed Effects, the Two-Way Mundlak Regression, and Difference-in-Differences Estimators](https://papers.ssrn.com/sol3/papers.cfm?abstract_id=3906345), [Difference-in-Differences with multiple time periods](https://www.sciencedirect.com/science/article/abs/pii/S0304407620303948) |


### 9장-통제집단합성법
| 챕터 | 내용 | 자료 링크 | 
| ------ |------|------|
| 9.4 표준 통제집단합성법 | 통제집단합성법에 대한 가정 | [Using Synthetic Controls: Feasibility, Data Requirements, and Methodological Aspects](https://www.aeaweb.org/articles?id=10.1257/jel.20191450) |
| 9.7 추론 | 더 알아보기 | [An Exact and Robust Conformal Inference Method for Counterfactual and Synthetic Controls](https://arxiv.org/abs/1712.09089) |
| 9.8.4 통제집단합성법과 이중차분법 | 원본 합성 이중차분법 | [Synthetic Difference-in-Differences](https://www.aeaweb.org/articles?id=10.1257/aer.20190159) |
| 9.9 요약 | 일반화 통제집단합성법 | [Generalized Synthetic Control Method: Causal Inference with Interactive Fixed Effects Models](https://www.cambridge.org/core/journals/political-analysis/article/generalized-synthetic-control-method-causal-inference-with-interactive-fixed-effects-models/B63A8BD7C239DD4141C67DA10CD0E4F3), [A Bayesian Alternative to Synthetic Control for Comparative Case Studies](https://www.cambridge.org/core/journals/political-analysis/article/bayesian-alternative-to-synthetic-control-for-comparative-case-studies/C23BD67E4BBBB8C88ADAEAE169696A45) |
| 9.9 요약 | 실제 사례: causalimpact 라이브러리  | [CausalImpact Github](https://github.com/google/CausalImpact?tab=readme-ov-file) |

### 10장-스위치백 실험
| 챕터 | 내용 | 자료 링크 | 
| ------ |------|------|